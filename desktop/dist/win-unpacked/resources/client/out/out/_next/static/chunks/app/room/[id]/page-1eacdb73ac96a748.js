(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[930],{125:(e,t,a)=>{"use strict";var l=a(2115),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=l.useState,r=l.useEffect,o=l.useLayoutEffect,i=l.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!n(e,a)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),l=s({inst:{value:a,getSnapshot:t}}),n=l[0].inst,d=l[1];return o(function(){n.value=a,n.getSnapshot=t,c(n)&&d({inst:n})},[e,a,t]),r(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),i(a),a};t.useSyncExternalStore=void 0!==l.useSyncExternalStore?l.useSyncExternalStore:d},1186:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>x,gC:()=>p,l6:()=>d,yv:()=>m});var l=a(5155),n=a(2115),s=a(883),r=a(9007),o=a(2614),i=a(2251),c=a(4269);let d=s.bL;s.YJ;let m=s.WT,u=n.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,l.jsxs)(s.l9,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...o,children:[n,(0,l.jsx)(s.In,{asChild:!0,children:(0,l.jsx)(r.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=s.l9.displayName;let f=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,l.jsx)(o.A,{className:"h-4 w-4"})})});f.displayName=s.PP.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,l.jsx)(r.A,{className:"h-4 w-4"})})});h.displayName=s.wn.displayName;let p=n.forwardRef((e,t)=>{let{className:a,children:n,position:r="popper",...o}=e;return(0,l.jsx)(s.ZL,{children:(0,l.jsxs)(s.UC,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...o,children:[(0,l.jsx)(f,{}),(0,l.jsx)(s.LM,{className:(0,c.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,l.jsx)(h,{})]})})});p.displayName=s.UC.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.JU,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=s.JU.displayName;let x=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,l.jsxs)(s.q7,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(s.VF,{children:(0,l.jsx)(i.A,{className:"h-4 w-4"})})}),(0,l.jsx)(s.p4,{children:n})]})});x.displayName=s.q7.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=s.wv.displayName},1548:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(4294).A)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},3179:(e,t,a)=>{"use strict";a.d(t,{i:()=>o});var l=a(9829);let n="https://loteria-gfrn.onrender.com";class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}getLastRoom(){return this.lastRoom}onRoomJoined(e){return this.socket.on("roomJoined",e),()=>this.socket.off("roomJoined",e)}onGameUpdate(e){return this.socket.on("gameUpdated",e),()=>this.socket.off("gameUpdated",e)}onRoomUpdate(e){return this.socket.on("roomUpdated",e),()=>this.socket.off("roomUpdated",e)}onPlayerJoined(e){return this.socket.on("playerJoined",e),()=>this.socket.off("playerJoined",e)}onPlayerLeft(e){return this.socket.on("playerLeft",e),()=>this.socket.off("playerLeft",e)}onGameStartCountdown(e){return this.socket.on("gameStartCountdown",e),()=>this.socket.off("gameStartCountdown",e)}async ensureConnection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;if(!this.socket.connected){if(this.connecting)return void await new Promise(t=>{let a=setInterval(()=>{this.socket.connected&&(clearInterval(a),t())},100);setTimeout(()=>{clearInterval(a),t()},e)});this.connecting=!0,this.socket.connect(),await new Promise(t=>{let a=()=>{this.socket.off("connect",a),this.connecting=!1,t()};this.socket.once("connect",a),setTimeout(()=>{this.socket.off("connect",a),this.connecting=!1,t()},e)})}}async joinRoom(e,t,a){return await this.ensureConnection(),new Promise(l=>{let n=e=>{r(),this.lastRoom=e,l({success:!0,room:e})},s=e=>{r(),l({success:!1,error:e})},r=()=>{this.socket.off("roomJoined",n),this.socket.off("joinError",s),this.socket.off("error",s)};this.socket.once("roomJoined",n),this.socket.once("joinError",s),this.socket.once("error",s),this.socket.emit("joinRoom",{roomId:e,playerName:t,playerData:a})})}async leaveRoom(e,t){try{await this.ensureConnection(),this.socket.emit("leaveRoom",{roomId:e,playerName:t}),this.lastRoom=null}catch(e){}}updateRoom(e,t){return new Promise((a,l)=>{try{this.socket.emit("updateRoom",e,t,e=>{e?l(e):a()})}catch(e){l(e)}})}async emit(e){for(var t=arguments.length,a=Array(t>1?t-1:0),l=1;l<t;l++)a[l-1]=arguments[l];await this.ensureConnection();try{return new Promise((t,l)=>{try{this.socket.emit(e,...a,function(){for(var e=arguments.length,a=Array(e),n=0;n<e;n++)a[n]=arguments[n];return a&&0!==a.length?2===a.length&&a[0]?l(a[0]):t(a[0]):t(void 0)})}catch(e){console.error("[gameSocket] emit internal error",e),l(e)}})}catch(e){throw console.error("[gameSocket] emit error",e),e}}onClaimWinResult(e){return this.socket.on("claimWinResult",e),()=>this.socket.off("claimWinResult",e)}constructor(){this.connecting=!1,this.lastRoom=null,console.log("[gameSocket] Inicializando con SERVER_URL:",n),this.socket=(0,l.io)(n,{transports:["polling","websocket"],autoConnect:!1,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,path:"/socket.io/",secure:!0,rejectUnauthorized:!1,withCredentials:!0}),this.socket.on("roomJoined",e=>{this.lastRoom=e}),this.socket.on("connect",()=>{console.debug("[gameSocket] connected",this.socket.id)}),this.socket.on("disconnect",e=>{console.debug("[gameSocket] disconnected",e)}),this.socket.on("connect_error",e=>{console.error("[gameSocket] connect_error:",e)}),this.socket.on("error",e=>{console.error("[gameSocket] error:",e)})}}let r=null;function o(){return r||(r=s.getInstance()),r}},4806:(e,t,a)=>{"use strict";e.exports=a(125)},4812:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(4294).A)("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]])},5260:(e,t,a)=>{Promise.resolve().then(a.bind(a,7500))},6943:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(4294).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7500:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eu});var l=a(5155),n=a(2115),s=a(63),r=a(1398),o=a(5239);function i(e){let{card:t,isMarked:a,isClickable:n,onClick:s}=e;return(0,l.jsxs)("div",{className:"relative w-full h-full rounded-md overflow-hidden transition-all duration-300 ease-in-out transform hover:scale-105",onClick:n?s:void 0,role:"button","aria-label":"Marcar ".concat(t.name),tabIndex:n?0:-1,onKeyDown:e=>{n&&("Enter"===e.key||" "===e.key)&&s()},children:[(0,l.jsx)(o.default,{src:t.imageUrl,alt:t.name,fill:!0,sizes:"100%",className:"object-contain transition-all duration-500",draggable:!1,onContextMenu:e=>e.preventDefault()}),a&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,l.jsx)("div",{className:"   rounded-full bg-[#FBEEDF]/80 flex items-center justify-center text-white font-bold   animate-in fade-in zoom-in   w-12 h-12 md:w-12 md:h-12 sm:w-12 sm:h-12 lg:w-16 lg:h-16   aspect-square   ",children:(0,l.jsx)(o.default,{src:"/Loter\xeda SI-frijolito-negro64x64.png",alt:"Frijolito",width:64,height:64,className:"object-contain w-full h-full"})})})]})}function c(e){let{board:t,onCardClick:a,markedIndices:n,calledCardIds:s,isAllowed:r}=e;return n.length,(0,l.jsx)("div",{className:"grid grid-cols-4 gap-0 p-2 rounded-lg bg-secondary border-1 border-primary/20 w-full h-full",children:t.map((e,t)=>{let o=Math.floor(t/4),c=t%4,d=!r||r({row:o,col:c});return(0,l.jsx)("div",{className:"w-full h-full transition-all duration-200 ".concat(d?"":"grayscale opacity-50 pointer-events-none"),children:(0,l.jsx)(i,{card:e,isMarked:n.includes(t),isClickable:d&&s.includes(e.id)&&!n.includes(t),onClick:async()=>d&&await a(e,t)})},e.id)})})}var d=a(6948);function m(e){let{currentCard:t=null,history:a=[],showCurrentCard:n=!0,showHistory:s=!0}=e;return(0,l.jsxs)("div",{className:"\n        flex flex-col gap-4 md:flex-row md:gap-4 items-center md:items-start\n      ",children:[n&&(0,l.jsx)("div",{className:"flex justify-center items-center w-full",children:(0,l.jsx)(d.Zp,{className:"   w-[clamp(160px,20vw,250px)]   aspect-[3/4]   overflow-hidden    border-2 border-primary    bg-card   ",style:{borderColor:"hsl(180.85, 61.74%, 22.55%)",backgroundColor:"hsl(240, 26.39%, 28.24%)",borderWidth:"1px"},children:t?(0,l.jsx)("div",{className:"relative w-full h-full",children:(0,l.jsx)(o.default,{src:t.imageUrl,alt:t.name,fill:!0,priority:!0})}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-muted/50",children:(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:" \xbfEst\xe1s listo?"})})})}),s&&(0,l.jsx)("div",{className:"flex-1 min-w-0",children:(0,l.jsx)(d.Zp,{className:"h-full",style:{background:"hsl(240, 26.39%, 28.24%)"},children:(0,l.jsx)(d.Wu,{className:"p-2",children:(0,l.jsx)("div",{className:"w-full h-[clamp(60px,12vw,90px)] flex flex-row gap-2 p-2 justify-center",children:[...a].reverse().map((e,t)=>(0,l.jsx)("div",{className:"   w-[clamp(35px,6vw,50px)]   aspect-[3/4]   relative rounded-md    overflow-hidden border border-border   ",children:(0,l.jsx)(o.default,{src:e.imageUrl,alt:e.name,fill:!0,className:"object-cover"})},"".concat(e.id,"-").concat(t)))})})})})]})}var u=a(8053),f=a(3998),h=a(3242);function p(e){let{open:t,onRestart:a,ranking:n,gameMode:s,currentPlayer:r,winnerName:o}=e,i=Array.isArray(n)?n:[];return(0,l.jsx)(u.Lt,{open:t,children:(0,l.jsxs)(u.EO,{className:"   \xa0 \xa0 \xa0 \xa0 \xa0 bg-cover bg-center border-none   \xa0 \xa0 \xa0 \xa0 \xa0 rounded-2xl shadow-lg overflow-hidden   \xa0 \xa0 \xa0 \xa0 \xa0 text-white text-center   \xa0 \xa0 \xa0 \xa0 \xa0 w-[90vw] max-w-[520px] sm:max-w-[480px] md:max-w-[500px] lg:max-w-[520px]   \xa0 \xa0 \xa0 \xa0 \xa0 aspect-[16/10] sm:aspect-[16/10] xs:aspect-auto   \xa0 \xa0 \xa0 \xa0 \xa0 transition-all duration-300 ease-in-out   \xa0 \xa0 \xa0 \xa0 \xa0 flex flex-col justify-between items-center   \xa0 \xa0 \xa0 \xa0 \xa0 min-h-[340px]   \xa0 \xa0 \xa0 \xa0 ",style:{backgroundImage:"url('/LoteriaGanadorModal.png')",backgroundPosition:"center"},children:[(0,l.jsx)("div",{className:"flex-grow w-full flex flex-col justify-center items-center px-[clamp(0.5rem,3vw,1.5rem)] py-[clamp(1rem,4vw,2rem)]",children:(0,l.jsxs)(u.wd,{children:[(0,l.jsx)(u.r7,{children:(0,l.jsx)(h.s6,{children:"Ganador del juego"})}),(0,l.jsx)(u.$v,{asChild:!0,className:"flex flex-col justify-center items-center    \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 text-[clamp(1rem,2vw,1.3rem)]   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 leading-snug",children:(0,l.jsx)("div",{className:"text-center text-lg text-black pt-[clamp(1rem,10vw,5rem)] text-[clamp(1.1rem,2.5vw,1.4rem)]",children:(0,l.jsx)("div",{className:"   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 absolute left-1/2 top-1/2 translate-x-[-50%] translate-y-[-20%]   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 w-[clamp(220px,60vw,270px)] min-h-[120px] max-h-[210px]   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 bg-white/50 rounded-xl shadow-lg flex flex-col justify-center items-center z-10   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 px-6 py-4   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",children:(0,l.jsx)("ol",{className:"space-y-1",children:i.slice(0,3).map((e,t)=>(0,l.jsxs)("li",{className:"font-bold text-[clamp(1rem,2vw,1.3rem)] text-[#165c5d]",children:[0===t&&"\uD83E\uDD47",1===t&&"\uD83E\uDD48",2===t&&"\uD83E\uDD49"," ".concat(e.name)]},e.name))})})})})]})}),(0,l.jsx)("div",{className:"mt-auto",children:a&&(0,l.jsx)(u.ck,{className:"flex justify-center mt-[clamp(0.8rem, 2vw, 1.5rem)]",children:(0,l.jsx)(f.$,{onClick:a,size:"sm",className:"   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 w-[clamp(10rem, 80vw, 20rem)]   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 text-[clamp(0.9rem, 2vw, 1.1rem)]   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 px-[clamp(1rem, 3vw, 2rem)] py-[clamp(0.4rem, 1vw, 0.8rem)]   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 shadow-md   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 transition-all duration-200 ease-in-out   \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",children:"Jugar de Nuevo"})})})]})})}var x=a(3594),g=a(4294);let y=(0,g.A)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);var w=a(7639);let v=(0,g.A)("VolumeOff",[["path",{d:"M16 9a5 5 0 0 1 .95 2.293",key:"1fgyg8"}],["path",{d:"M19.364 5.636a9 9 0 0 1 1.889 9.96",key:"l3zxae"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"m7 7-.587.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298V11",key:"1gbwow"}],["path",{d:"M9.828 4.172A.686.686 0 0 1 11 4.657v.686",key:"s2je0y"}]]);var j=a(4812);let N=(0,g.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var b=a(6943);let k=(0,g.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),C=(0,g.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var S=a(1548),R=a(3468),A=a(222),E=a(4129),I=a(7602),L=a(4806);function M(){return()=>{}}var D="Avatar",[z,U]=(0,R.A)(D),[O,P]=z(D),G=n.forwardRef((e,t)=>{let{__scopeAvatar:a,...s}=e,[r,o]=n.useState("idle");return(0,l.jsx)(O,{scope:a,imageLoadingStatus:r,onImageLoadingStatusChange:o,children:(0,l.jsx)(I.sG.span,{...s,ref:t})})});G.displayName=D;var J="AvatarImage",T=n.forwardRef((e,t)=>{let{__scopeAvatar:a,src:s,onLoadingStatusChange:r=()=>{},...o}=e,i=P(J,a),c=function(e,t){let{referrerPolicy:a,crossOrigin:l}=t,s=(0,L.useSyncExternalStore)(M,()=>!0,()=>!1),r=n.useRef(null),o=s?(r.current||(r.current=new window.Image),r.current):null,[i,c]=n.useState(()=>W(o,e));return(0,E.N)(()=>{c(W(o,e))},[o,e]),(0,E.N)(()=>{let e=e=>()=>{c(e)};if(!o)return;let t=e("loaded"),n=e("error");return o.addEventListener("load",t),o.addEventListener("error",n),a&&(o.referrerPolicy=a),"string"==typeof l&&(o.crossOrigin=l),()=>{o.removeEventListener("load",t),o.removeEventListener("error",n)}},[o,l,a]),i}(s,o),d=(0,A.c)(e=>{r(e),i.onImageLoadingStatusChange(e)});return(0,E.N)(()=>{"idle"!==c&&d(c)},[c,d]),"loaded"===c?(0,l.jsx)(I.sG.img,{...o,ref:t,src:s}):null});T.displayName=J;var $="AvatarFallback",V=n.forwardRef((e,t)=>{let{__scopeAvatar:a,delayMs:s,...r}=e,o=P($,a),[i,c]=n.useState(void 0===s);return n.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(e)}},[s]),i&&"loaded"!==o.imageLoadingStatus?(0,l.jsx)(I.sG.span,{...r,ref:t}):null});function W(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}V.displayName=$;var q=a(4269);let Z=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(G,{ref:t,className:(0,q.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n})});Z.displayName=G.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(T,{ref:t,className:(0,q.cn)("aspect-square h-full w-full",a),...n})}).displayName=T.displayName;let _=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(V,{ref:t,className:(0,q.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n})});function F(e){let{players:t,currentPlayerName:a,hostName:s,roomId:r}=e,[o,i]=(0,n.useState)(!0),c=Object.values(t);return(0,l.jsxs)(d.Zp,{children:[(0,l.jsxs)(d.aR,{className:"pb-2",children:[r&&(0,l.jsx)("div",{className:"text-white font-bold mb-2 text-center",style:{fontSize:"clamp(14px, 2vw, 14px)"},children:r?({sala_1:"Sala 1",sala_2:"Sala 2",sala_3:"Sala 3",sala_4:"Sala 4"})[r]||r:""}),(0,l.jsxs)(d.ZB,{className:"   flex flex-wrap items-center justify-center text-center gap-3   sm:flex-nowrap   ",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2 font-semibold text-white",style:{fontSize:"clamp(14px, 2vw, 14px)"},children:[(0,l.jsx)(b.A,{className:"w-4 h-4 shrink-0 hidden md:inline"}),(0,l.jsxs)("span",{className:"whitespace-nowrap",children:["Jugadores (",c.filter(e=>e.isOnline).length,")"]})]}),(0,l.jsx)("button",{onClick:()=>i(!o),className:"w-6 h-6 rounded-full flex items-center justify-center bg-[hsl(var(--primary))] text-white text-lg",children:o?(0,l.jsx)(k,{className:"w-5 h-5"}):(0,l.jsx)(C,{className:"w-5 h-5"})})]})]}),(0,l.jsx)(d.Wu,{children:(0,l.jsx)("div",{className:(0,q.cn)("transition-all duration-500 ease-in-out overflow-hidden",o?"opacity-100":"max-h-0 opacity-0"),children:(0,l.jsx)("div",{className:"overflow-y-auto custom-scrollbar hide-scrollbar",style:{maxHeight:"6.5rem",paddingRight:"0.75rem",WebkitOverflowScrolling:"touch",scrollbarGutter:"stable",display:o?"block":"none"},children:(0,l.jsx)("ul",{className:"space-y-3 py-2",children:c.map(e=>(0,l.jsxs)("li",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(Z,{className:(0,q.cn)("border-2",e.isOnline?"border-green-500":"border-gray-400"),children:(0,l.jsx)(_,{children:e.name.substring(0,2).toUpperCase()})}),(0,l.jsx)("span",{className:(0,q.cn)("font-medium text-sm",e.name===a&&"text-primary"),children:(0,l.jsxs)("span",{className:"font-medium",children:[(0,l.jsx)("span",{className:"text-[hsl(var(--foreground))]",children:e.name}),e.name===a&&(0,l.jsx)("span",{className:"text-[hsl(var(--primary))]",children:" (T\xfa)"})]})})]}),e.name===s&&(0,l.jsx)(S.A,{className:"w-5 h-6 text-yellow-500",children:(0,l.jsx)("title",{children:"Anfitri\xf3n"})})]},e.name))})})})})]})}_.displayName=V.displayName;var H=a(3179),B=a(1186),Y=a(7539),X=a(6615);let K=Y.bL;Y.l9;let Q=Y.ZL;Y.bm;let ee=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(Y.hJ,{ref:t,className:(0,q.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});ee.displayName=Y.hJ.displayName;let et=n.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,l.jsxs)(Q,{children:[(0,l.jsx)(ee,{}),(0,l.jsxs)(Y.UC,{ref:t,className:(0,q.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s,children:[n,(0,l.jsxs)(Y.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(X.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});et.displayName=Y.UC.displayName;let ea=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,q.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};ea.displayName="DialogHeader";let el=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(Y.hE,{ref:t,className:(0,q.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});el.displayName=Y.hE.displayName;let en=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(Y.VY,{ref:t,className:(0,q.cn)("text-sm text-muted-foreground",a),...n})});function es(e){let{open:t,onStay:a,onExit:s}=e;return(0,n.useEffect)(()=>{if(!t)return;let e=setTimeout(()=>{s()},5e3);return()=>clearTimeout(e)},[t,s]),(0,l.jsx)(K,{open:t,children:(0,l.jsxs)(et,{className:"max-w-sm",style:{backgroundColor:"hsl(180.85 61.74% 22.55%)"},children:[(0,l.jsx)("button",{className:"   absolute top-3 right-3   w-8 h-8 rounded-sm   bg-[#165C5D] hover:bg-[#D4165C]   flex items-center justify-center   border border-gray-200 shadow-sm   transition-colors duration-150   z-20   ","aria-label":"Cerrar",onClick:a,children:(0,l.jsx)(X.A,{className:"w-4 h-4 text-white"})}),(0,l.jsxs)(ea,{children:[(0,l.jsx)(el,{className:"text-white",children:"\xbfSigues ah\xed?"}),(0,l.jsx)(en,{className:"text-white/90",children:"Detectamos inactividad. Si no respondes, tu sesi\xf3n finalizar\xe1."})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,l.jsx)(f.$,{variant:"outline",onClick:a,style:{backgroundColor:"hsl(337.89 81.2% 45.88%)"},children:"S\xed, sigo aqu\xed"}),(0,l.jsx)(f.$,{variant:"destructive",onClick:s,children:"Salir"})]})]})})}function er(e){let{open:t,onClose:a}=e;return(0,l.jsx)(u.Lt,{open:t,children:(0,l.jsxs)(u.EO,{className:"   max-w-sm w-[90vw]   pt-4 px-6 pb-6   ",children:[(0,l.jsx)(u.Zr,{asChild:!0,children:(0,l.jsx)("button",{className:"   absolute    top-3 right-3   rounded-full    p-1.5   bg-[#165C5D]   hover:bg-[#1E7374]   border border-gray-200   shadow-sm   transition-all   duration-200   w-7 h-7   flex items-center justify-center   ","aria-label":"Cerrar",onClick:a,children:(0,l.jsx)(X.A,{className:"w-4 h-4 text-[#00000] hover:text-gray-700"})})}),(0,l.jsxs)(u.wd,{className:"mt-6",children:[(0,l.jsx)(u.r7,{className:"text-lg font-semibold text-center",children:"Seleccionar modo de juego"}),(0,l.jsx)(u.$v,{className:"text-center text-sm text-muted-foreground mt-2",children:"Debes seleccionar un modo de juego antes de iniciar la partida."})]}),(0,l.jsx)(u.ck,{className:"mt-6",children:(0,l.jsx)("div",{className:"w-full flex justify-center",children:(0,l.jsx)(f.$,{onClick:a,className:"   w-[min(80%,240px)]   bg-[hsl(180.85,61.74%,22.55%)]   hover:bg-[hsl(180.85,61.74%,25%)]   text-white   ",children:"Ok"})})})]})})}function eo(e){let{open:t,onClose:a,onConfirm:n}=e;return(0,l.jsx)(u.Lt,{open:t,children:(0,l.jsxs)(u.EO,{className:"max-w-sm w-[90vw] pt-4 px-6 pb-6",children:[(0,l.jsx)(u.Zr,{asChild:!0,children:(0,l.jsx)("button",{className:"   absolute top-3 right-3 rounded-full p-1.5   bg-[#165C5D] hover:bg-[#1E7374] border border-gray-200   shadow-sm transition-all duration-200 w-7 h-7 flex items-center justify-center   ","aria-label":"Cerrar",onClick:a,children:(0,l.jsx)(X.A,{className:"w-4 h-4 text-[#00000] hover:text-gray-700"})})}),(0,l.jsxs)(u.wd,{className:"mt-6",children:[(0,l.jsx)(u.r7,{className:"text-lg font-semibold text-center",children:"\xbfSalir de la sala?"}),(0,l.jsx)(u.$v,{className:"text-center text-sm text-muted-foreground mt-2",children:"Si sales de la sala perder\xe1s la conexi\xf3n y tu progreso en el juego. \xbfEst\xe1s seguro de que deseas salir?"})]}),(0,l.jsx)(u.ck,{className:"mt-6",children:(0,l.jsxs)("div",{className:"w-full flex flex-col sm:flex-row gap-3",children:[(0,l.jsx)(u.Zr,{asChild:!0,children:(0,l.jsx)("button",{onClick:a,className:"w-full sm:w-[48%] px-3 py-2 rounded-md bg-[#165c5d] hover:bg-[#1e7374] text-white",children:"Cancelar"})}),(0,l.jsx)(f.$,{onClick:n,className:"w-full sm:w-[48%] bg-[#D4165C] hover:bg-[#AA124A] text-white",children:"Salir"})]})})]})})}function ei(e){let{open:t,countdownValue:a}=e,n=null!==a&&a>0,s=0===a;return(0,l.jsx)(u.Lt,{open:t,children:(0,l.jsxs)(u.EO,{className:"border-0 bg-transparent shadow-none max-w-sm w-[90vw] flex items-center justify-center p-0",children:[(0,l.jsx)(u.r7,{asChild:!0,children:(0,l.jsx)(h.s6,{children:"Cuenta regresiva de inicio de juego"})}),(0,l.jsx)(u.$v,{asChild:!0,children:(0,l.jsx)(h.s6,{children:"El juego comienza en breve"})}),(0,l.jsxs)("div",{className:"\n                        flex items-center justify-center\n                        rounded-full font-bold text-white\n                        transition-all duration-300 ease-in-out\n                        ".concat(n?"bg-primary/80":"","\n                        ").concat(s?"bg-accent/80":"","\n                    "),style:{width:"clamp(140px, 50vw, 320px)",height:"clamp(140px, 50vw, 320px)",fontSize:n?"clamp(6rem, 15vw, 12rem)":"clamp(2rem, 10vw, 3rem)",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",flexDirection:"column"},children:[n&&(0,l.jsx)("span",{children:a}),s&&(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)("span",{className:"text-center",children:"\xa1JUGUEMOS!"})})]})]})})}function ec(e){let{children:t,minWidth:a=1400,maxScale:n=1.45,className:s=""}=e,r="clamp(1, calc(100vw / ".concat(a,"px), ").concat(n,")");return(0,l.jsx)("div",{className:"w-full flex justify-center ".concat(s),style:{position:"relative"},children:(0,l.jsx)("div",{style:{"--ui-scale":r,width:"calc(100% / var(--ui-scale))",transform:"scale(var(--ui-scale))",transformOrigin:"top center"},children:t})})}en.displayName=Y.VY.displayName;let ed={full:"Tradicional",horizontal:"Filas",vertical:"Columnas",diagonal:"Diagonales",corners:"Esquinas",square:"Cuadrado"};function em(e){var t,a,s,r,o,i;let{roomId:d,playerName:u,roomData:h}=e,[g,b]=(0,n.useState)([]),[k,C]=(0,n.useState)(h),[S,R]=(0,n.useState)(()=>{try{var e;return(null==h||null==(e=h.gameState)?void 0:e.gameMode)||""}catch(e){return""}});(0,n.useRef)(null);let A=null!=(o=null==k?void 0:k.gameState)?o:null,E=null!=(i=null==k?void 0:k.players)?i:{},I=E[u],L=I?{...I,markedIndices:Array.isArray(I.markedIndices)?I.markedIndices:[]}:void 0,[M,D]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=(null==A?void 0:A.host)===u;D(e),e&&!M&&console.log("✅ ".concat(u," ahora es el anfitri\xf3n"))},[null==A?void 0:A.host,u]),(0,n.useRef)(null);let[z,U]=(0,n.useState)(null);A&&(null!=A.winner||!1===A.isGameActive||Array.isArray(A.finalRanking)&&A.finalRanking.length);let[O,P]=(0,n.useState)(Date.now()),[G,J]=(0,n.useState)(!1),[T,$]=(0,n.useState)(!0),[V,W]=(0,n.useState)(!1),[q,Z]=(0,n.useState)(!1),[_,Y]=(0,n.useState)(null),[X,K]=(0,n.useState)(!0);(0,n.useEffect)(()=>{var e;let t=(0,H.i)(),a=t.onGameUpdate(e=>{C(t=>({...t,gameState:e}))}),l=t.onRoomUpdate(e=>{C(e)}),n=t.onPlayerJoined(e=>{let{playerName:t,playerData:a}=e;C(e=>({...e||{},players:{...(null==e?void 0:e.players)||{},[t]:a}}))}),s=t.onPlayerLeft(e=>{let{playerName:t}=e;C(e=>{let a={...(null==e?void 0:e.players)||{}};return delete a[t],{...e||{},players:a}})}),r=t.onClaimWinResult(e=>{e.success?console.log("✅ Victoria validada por servidor"):console.warn("❌ Victoria rechazada:",e.error||e.alreadyWinner)}),o=null==(e=t.onGameStartCountdown)?void 0:e.call(t,e=>{console.log("⏱️ Countdown recibido:",e),Y(e),0===e&&setTimeout(()=>Y(null),1500)});return()=>{a(),l(),n(),s(),r(),null==o||o()}},[]),(0,n.useEffect)(()=>{var e;if(null==k||null==(e=k.gameState)?void 0:e.winner){console.log("\uD83C\uDFC6 GANADOR DETECTADO EN CLIENTE:",k.gameState.winner);try{document&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}catch(e){}}},[null==k||null==(t=k.gameState)?void 0:t.winner]),(0,n.useEffect)(()=>{var e;let t=null==k||null==(e=k.gameState)?void 0:e.gameMode;t&&t!==S&&R(t)},[null==k||null==(a=k.gameState)?void 0:a.gameMode,S]);let Q=(null==k||null==(s=k.gameState)?void 0:s.gameMode)||S;(0,n.useEffect)(()=>{A&&(!A.isGameActive||A.winner||Array.isArray(A.finalRanking)&&A.finalRanking.length>0)&&U(null)},[null==A?void 0:A.isGameActive,null==A?void 0:A.winner,null==A?void 0:A.finalRanking]);let ee=async(e,t)=>{if(!L||!(null==A?void 0:A.isGameActive))return;let a=Array.isArray(L.markedIndices)?[...L.markedIndices]:[];a.includes(t)?(a.splice(a.indexOf(t),1),z&&4*z.row+z.col===t&&U(null)):a.push(t);let l=Math.floor(t/4),n=t%4;!z&&Q&&"full"!==Q&&U({row:l,col:n});try{var s,r,o;C(e=>{var t;return{...e,players:{...(null==e?void 0:e.players)||{},[u]:{...(null==e||null==(t=e.players)?void 0:t[u])||{},markedIndices:a}}}}),null==(r=(o=(0,H.i)()).updateRoom)||r.call(o,d,{players:{...(null==k?void 0:k.players)||{},[u]:{...(null==k||null==(s=k.players)?void 0:s[u])||{},markedIndices:a}}}).catch(e=>console.warn("updateRoom error:",e));let e=Q||"full",t=z||("full"!==e?{row:l,col:n}:null);console.log("\uD83D\uDCE4 EMITIENDO claimWin:",{roomId:d,playerName:u,boardLength:L.board.length,markedIndices:a,markedCount:a.length,gameMode:e,firstCard:t,calledCardIds:A.calledCardIds});try{let l=await (0,H.i)().emit("claimWin",d,u,{board:L.board,markedIndices:a,gameMode:e,firstCard:t});console.log("✅ RESPUESTA claimWin:",l),(null==l?void 0:l.success)&&console.log("\uD83C\uDF89 VICTORIA CONFIRMADA POR SERVIDOR")}catch(e){console.error("❌ Error emitiendo claimWin:",e)}}catch(e){console.error("Error en handleCardClick:",e),C(e=>{var t;return{...e,players:{...(null==e?void 0:e.players)||{},[u]:{...(null==e||null==(t=e.players)?void 0:t[u])||{},markedIndices:L.markedIndices||[]}}}})}};(0,n.useEffect)(()=>{var e;let t=null==k||null==(e=k.gameState)?void 0:e.finalRanking;t&&t.length>0?b(t):b([])},[null==k||null==(r=k.gameState)?void 0:r.finalRanking]);let et=async()=>{if(M){if(!S)return void W(!0);try{console.log("\uD83C\uDFAE Iniciando juego en modo:",S);let e=(0,H.i)();await e.emit("startGameCountdown",d,S)}catch(e){console.error("Error iniciando juego:",e)}}},ea=async()=>{if(!M)return;let e={host:u,isGameActive:!1,winner:null,calledCardIds:[],gameMode:null,timestamp:Date.now(),finalRanking:null};C(t=>({...t||{},gameState:e})),await (0,H.i)().emit("updateRoom",d,{gameState:e}),b([]),U(null),R("")},el=async()=>{if(!L)return;let e={...k.players,[u]:{...L,board:(0,x.u7)(),markedIndices:[]}};C(t=>({...t||{},players:e})),U(null),await (0,H.i)().emit("updateRoom",d,{players:e}),b([])};if(!L||!A||!L.board)return(0,l.jsx)("div",{className:"flex flex-col gap-4 items-center justify-center h-64",children:(0,l.jsx)("p",{className:"text-xl text-muted-foreground",children:"Cargando sala, un momento..."})});let en=(Array.isArray(A.calledCardIds)?A.calledCardIds.map(e=>x.Y$.find(t=>t.id===e)).filter(Boolean):[]).filter((e,t,a)=>a.findIndex(t=>t.id===e.id)===t),em=X?en.slice(-3):[],eu=X&&em.length>0?em[em.length-1]:null;return(0,n.useEffect)(()=>{T&&(null==eu?void 0:eu.description)&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"es-MX",a=new Audio("/audios/".concat(e.id,".mp3"));a.onerror=()=>{!function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"es-MX";if(!("speechSynthesis"in window))return;window.speechSynthesis.cancel();let l=new window.SpeechSynthesisUtterance("".concat(e,". ").concat(t));l.lang=a,window.speechSynthesis.speak(l)}(e.name,e.description,t)},a.oncanplaythrough=()=>{a.play()},a.load()}(eu)},[eu,T]),(0,n.useEffect)(()=>{let e=()=>P(Date.now());return window.addEventListener("click",e),window.addEventListener("keydown",e),window.addEventListener("mousemove",e),()=>{window.removeEventListener("click",e),window.removeEventListener("keydown",e),window.removeEventListener("mousemove",e)}},[]),(0,n.useEffect)(()=>{let e=setInterval(()=>{Date.now()-O>9e4&&J(!0)},15e3);return()=>clearInterval(e)},[O]),(0,n.useEffect)(()=>{let e=null;return null!==_?(K(!1),0===_&&(e=setTimeout(()=>{K(!0)},1e3))):K(!0),()=>{e&&clearTimeout(e)}},[_]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(ec,{minWidth:1400,maxScale:1.45,children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-x-6 gap-y-4 md:gap-6 auto-rows-min items-start w-full",children:[(0,l.jsx)("div",{className:"flex justify-center col-span-1 md:col-span-3 gap-3",children:(0,l.jsxs)("div",{className:"w-[clamp(160px,18vw,260px)] flex flex-col gap-3",children:[(0,l.jsx)(F,{players:E,currentPlayerName:u,hostName:A.host||"",roomId:d}),(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[M&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(f.$,{onClick:et,disabled:A.isGameActive||!!A.winner,children:[(0,l.jsx)(y,{className:"mr-2"}),"Iniciar juego"]}),A.isGameActive&&!A.winner&&(0,l.jsx)(f.$,{onClick:async()=>{if(!M)return;let e={...k.players};Object.keys(e).forEach(t=>{e[t].markedIndices=[]}),C(t=>({...t||{},players:e,gameState:{...(null==t?void 0:t.gameState)||{},isGameActive:!1,winner:null,calledCardIds:[]}}));try{let t=(0,H.i)();t.emit("stopGameLoop",d),await t.emit("updateRoom",d,{players:e,gameState:{...A,isGameActive:!1,winner:null,calledCardIds:[]}})}catch(e){console.warn("Error notifying server when ending game:",e)}U(null),b([])},variant:"destructive",children:"Terminar juego"}),(0,l.jsx)("div",{className:"w-full",children:(0,l.jsxs)(B.l6,{value:S,onValueChange:async e=>{R(e),U(null);let t=(0,H.i)();await t.emit("updateRoom",d,{gameState:{...k.gameState,gameMode:e}})},children:[(0,l.jsx)(B.bq,{className:"w-full",disabled:A.isGameActive,children:(0,l.jsx)(B.yv,{placeholder:"Seleccionar modo de juego"})}),(0,l.jsx)(B.gC,{children:Object.entries(ed).map(e=>{let[t,a]=e;return(0,l.jsx)(B.eb,{value:t,children:a},t)})})]})})]}),(0,l.jsxs)(f.$,{onClick:el,variant:"outline",disabled:A.isGameActive,children:[(0,l.jsx)(w.A,{className:"mr-2"}),"Nueva tabla"]}),!M&&A.host&&!A.isGameActive&&!A.winner&&(0,l.jsxs)("p",{className:"text-center text-muted-foreground bg-muted py-2",children:[(0,l.jsx)("span",{className:"font-bold",children:A.host||"Anfitri\xf3n"})," es el anfitri\xf3n. Esperando..."]}),!M&&A.gameMode&&(0,l.jsx)("div",{className:"bg-primary/20 text-center py-2",children:(0,l.jsxs)("p",{className:"text-sm",children:["Modo:"," ",(0,l.jsx)("span",{className:"font-semibold",children:ed[A.gameMode]||A.gameMode})]})}),(0,l.jsx)(f.$,{variant:T?"default":"outline",onClick:()=>$(e=>!e),children:T?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v,{className:"mr-2"}),"Cantadito"]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.A,{className:"mr-2"}),"Cantadito"]})})]})]})}),(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4 col-span-1 md:col-span-5",children:[(0,l.jsx)("div",{className:"w-[clamp(180px,17vw,250px)] md:w-[clamp(140px,18vw,250px)]",children:(0,l.jsx)(m,{currentCard:null,history:em,showCurrentCard:!1,showHistory:!0})}),(0,l.jsx)("div",{className:"w-[clamp(160px,17vw,250px)] md:w-[clamp(140px,18vw,250px)] aspect-[3/4]",children:(0,l.jsx)(m,{currentCard:eu,showCurrentCard:!0,showHistory:!1})})]}),(0,l.jsx)("div",{className:"flex justify-center col-span-1 md:col-span-4 gap-3 mt-0 md:mt-0",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"md:pb-12",children:(0,l.jsx)("div",{className:"mx-auto w-[clamp(300px,92vw,560px)] md:w-[clamp(220px,28vw,400px)] aspect-[265/380]",children:(0,l.jsx)(c,{board:L.board,onCardClick:ee,markedIndices:L.markedIndices,calledCardIds:Array.isArray(A.calledCardIds)?A.calledCardIds:[],isAllowed:e=>{let t=4*e.row+e.col,a=Q||"full";return"diagonal"!==a||z?"corners"===a?[0,3,12,15].includes(t):"square"!==a||z?!z||(0,x.x$)(a||"full",z)(e):[5,6,9,10].includes(t):[0,5,10,15,3,6,9,12].includes(t)}})})}),(0,l.jsx)("div",{className:"hidden md:flex absolute right-0 bottom-[-2px] z-20",children:(0,l.jsx)(f.$,{size:"icon",className:"bg-[#D4165C] text-white hover:bg-[#AA124A] border-2 border-primary",onClick:()=>Z(!0),"aria-label":"Salir de la sala",children:(0,l.jsx)(N,{})})}),(0,l.jsx)("div",{className:"mt-3 md:hidden flex justify-center",children:(0,l.jsx)(f.$,{size:"sm",className:"bg-[#D4165C] text-white hover:bg-[#AA124A] border-2 border-primary",onClick:()=>Z(!0),children:(0,l.jsx)(N,{})})})]})}),(0,l.jsx)(er,{open:V,onClose:()=>W(!1)}),(0,l.jsx)(p,{open:!!(null==A?void 0:A.winner)||Array.isArray(null==A?void 0:A.finalRanking)&&A.finalRanking.length>0,ranking:Array.isArray(null==A?void 0:A.finalRanking)&&A.finalRanking.length>0?A.finalRanking:g,gameMode:A.gameMode,currentPlayer:u,winnerName:A.winner,onRestart:M?ea:void 0}),(0,l.jsx)(es,{open:G,onStay:()=>{J(!1),P(Date.now())},onExit:()=>{window.location.href="/"}}),(0,l.jsx)(eo,{open:q,onClose:()=>Z(!1),onConfirm:()=>{window.location.href="/"}}),(0,l.jsx)(ei,{open:null!==_,countdownValue:_})]})})})}function eu(){let e=(0,s.useSearchParams)(),t=(0,s.useParams)(),a=(0,s.useRouter)(),o=e.get("name"),i=e.get("initialRoom"),c=t.id,[d,m]=(0,n.useState)(()=>{try{return i?JSON.parse(i):null}catch(e){return null}}),[u,f]=(0,n.useState)(!i);return((0,n.useEffect)(()=>{try{if("1"===sessionStorage.getItem("loteria:justJoined"))return void sessionStorage.removeItem("loteria:justJoined")}catch(e){}try{let e=performance&&performance.getEntriesByType?performance.getEntriesByType("navigation"):[],t=e&&e[0]&&e[0].type||(performance&&performance.navigation&&1===performance.navigation.type?"reload":void 0);if("reload"===t){if(!c||!o)return void a.replace("/");(async()=>{try{let e=(0,H.i)();if(e&&"function"==typeof e.leaveRoom)await e.leaveRoom(c,o);else if(navigator&&navigator.sendBeacon)try{let e="/api/leaveRoom?roomId=".concat(encodeURIComponent(c),"&name=").concat(encodeURIComponent(o));navigator.sendBeacon(e,"")}catch(e){}else try{await fetch("/api/leaveRoom?roomId=".concat(encodeURIComponent(c),"&name=").concat(encodeURIComponent(o)),{method:"POST",keepalive:!0})}catch(e){}}catch(e){console.warn("leaveRoom during reload failed:",e)}finally{a.replace("/")}})()}}catch(e){}},[]),(0,n.useEffect)(()=>{if(!c||!o)return;let e=(0,H.i)();if(!d){var t,a;let l=null==(t=e.getLastRoom)?void 0:t.call(e);if(l&&(null==(a=l.players)?void 0:a[o]))m(l),f(!1);else{let t=e.onRoomJoined(e=>{console.log("[RoomPage] Recibido roomJoined:",e),m(e),f(!1)});return()=>{t()}}}let l=e.onGameUpdate(e=>{m(t=>({...t,gameState:e}))}),n=e.onPlayerJoined(e=>{let{playerName:t,playerData:a}=e;m(e=>({...e,players:{...(null==e?void 0:e.players)||{},[t]:a}}))}),s=e.onPlayerLeft(e=>{let{playerName:t}=e;m(e=>{if(!(null==e?void 0:e.players))return e;let a={...e.players};return delete a[t],{...e,players:a}})});return()=>{l(),n(),s()}},[c,o]),(0,n.useEffect)(()=>{o&&(u||d)||a.replace("/")},[o,u,d,a]),!u&&o&&d&&d.players&&d.players[o])?(0,l.jsxs)("div",{className:"flex flex-col min-h-screen bg-background text-foreground",children:[(0,l.jsx)(r.Y,{}),(0,l.jsx)("main",{className:"flex-grow container mx-auto p-4 md:p-6",children:(0,l.jsx)(em,{roomId:c,playerName:o,roomData:d})})]}):(0,l.jsx)("div",{className:"flex flex-col items-center justify-center h-64",children:(0,l.jsx)("p",{className:"text-lg text-muted-foreground",children:"Est\xe1s siendo redirigido, espera un momento..."})})}},7639:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(4294).A)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]])},8053:(e,t,a)=>{"use strict";a.d(t,{$v:()=>p,EO:()=>m,Lt:()=>i,Zr:()=>x,ck:()=>f,r7:()=>h,wd:()=>u});var l=a(5155),n=a(2115),s=a(5646),r=a(4269),o=a(3998);let i=s.bL;s.l9;let c=s.ZL,d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.hJ,{className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t})});d.displayName=s.hJ.displayName;let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsxs)(c,{children:[(0,l.jsx)(d,{}),(0,l.jsx)(s.UC,{ref:t,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n})]})});m.displayName=s.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};u.displayName="AlertDialogHeader";let f=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="AlertDialogFooter";let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.hE,{ref:t,className:(0,r.cn)("text-lg font-semibold",a),...n})});h.displayName=s.hE.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.VY,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...n})});p.displayName=s.VY.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.rc,{ref:t,className:(0,r.cn)((0,o.r)(),a),...n})}).displayName=s.rc.displayName;let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,l.jsx)(s.ZD,{ref:t,className:(0,r.cn)((0,o.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...n})});x.displayName=s.ZD.displayName}},e=>{e.O(0,[873,617,239,835,441,255,358],()=>e(e.s=5260)),_N_E=e.O()}]);